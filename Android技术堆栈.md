# Android技术堆栈

## 基础知识



## 性能优化

## 逆向安全

## 需求解决

```
下载APK，如何保证文件的完整性和正确性？
1、对比下载文件的md5或sha1，与服务端对比，保证完整性和正确性。
2、读取下载文件的length，与服务端对比，保证完整性。
3、如果文件是zip，检测zip文件结尾的特殊编码格式，检测是否zip合法，保证完整性和正确性。
```

```
如何进行APK增量升级更新？
用户在升级版本时，不需要下载完整的安装包，只需下载增加的部分即可体验新版本完整功能，即节约用户流量，也减少服务器流量，并解决了多渠道问题。
增量更新的原理是将旧版apk和新版apk进行二进制对比，得到差异包，升级更新时，根据本地版本从服务器下载需要的差分包，使用本地版本和差分包生成新版apk。
把渠道号写入安装包的注释字段，Android apk安装包是zip格式文件，在zip文件的最后有一个记录说明。
```



## 文件系统

```
ZIP:
End of central directory record，核心目录结束标记，每个zip只会出现一次。
如何判断一个文件是ZIP文件？
0x06054b50位置是在zip.length减去22个字节，seek到该位置，读4个字节看是否是0x06054b50，可以确定zip是否完整。
bsdiff.c用于生成差异包，bspatch.c用于合成apk，makefile是生成可执行文件的脚本，执行makefile文件，可生成一个bsdiff工具，使用该工具即可生成差异包。
```

```
二进制比较工具：
bsdiff
```



## 密码摘要

```
MD5
SHA1
```

